% Created 2022-10-21 Fri 18:49
% Intended LaTeX compiler: pdflatex
\documentclass[hidelinks,11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage{caption}
\usepackage{subcaption} % sufigures facilities
\usepackage{float} % for H option
\usepackage{xcolor} % for the textcolor command
\usepackage[a4paper,width=150mm,top=25mm,bottom=25mm]{geometry} % fixes margins
\author{Marcelo Veloso Maciel}
\date{}
\title{Working Paper}
\hypersetup{
 pdfauthor={Marcelo Veloso Maciel},
 pdftitle={W4 Essay},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 28.2 (Org mode 9.6)},
 pdflang={English}}
\usepackage[authordate,strict,backend=biber,
bibencoding=inputenc]{biblatex-chicago}

\addbibresource{refs.bib}
\begin{document}

\maketitle


% parencite for indirect citation, textcite for direct citation

\section{Introduction}
The rise of polarization, the specter of democratic backsliding, and more
generally an apprehension with the survival prospects of democratic polities
have led to a renewed interest in what institutions mitigate vs. instigate
destabilizing dynamics, or that increase the adaptability of the political
system vis-{\'a}-vis both internal and external stressors
\parencite{Bednare2113843118, przeworski2019crises, chiopris2021wolf,
, tarko2014institutional}. Given their centrality to the input-output between
society and the state, electoral institutions naturally figure among the set of
such institutions under scrutiny \parencite{Wange2021systems}, and a strand of
the literature on collective choice has wondered whether the current electoral
victories of divisive candidates have not been an effect of informationally poor
decision procedures \parencite{potthoff2021condorcet, kurrild2018trump,
  woon2020trump}. This paper shows, however, that in 2018 presidential
election in Brazil, a highly polarized one, the election of a divisive
candidate, Jair Messias Bolsonaro, was not an artifact of the decision
procedure.

Despite the multiple historical contingencies that might explain his victory,
one might naturally wonder what role the electoral system has had in it. After
all, it is well-known that the outcome of collective choices is fundamentally
dependent on the voting procedure \parencite{riker1982liberalism}. As Brazil's
majority with run-off system, most electoral systems use merely the first index
of the voters' preference rankings \parencite{grofman04_if_you_like_alter_vote}.
How would he have fared under informationally richer voting procedures, such as
pairwise comparison methods and positional voting procedures? Was he, and
arguably another democratically elected destabilizing candidate, a product of
decision procedures that favor divisive candidates over more inclusive ones
\parencite{igersheim22_compar_votin_method}? Would the result have changed with
a different set of candidates?

To answer those questions, I use a pre-electoral representative survey
to reconstruct the full 4-top rankings of the Brazilian population, using a
preference learning model \parencite{sorensen2019bayesmallows}. Subsequently, I
use this augmented data to simulate the electoral results under the Borda
and Condorcet procedures and simulate the result for all positional procedures
in the top 4 and 3 candidate sets. Finally, I discuss the significance of the
results and conclude by pointing out the limitations of the endeavor.


\section{Theory}
There are multiple ways in which electoral institutions affect the Polity. Even if we restrict our attention to a single rule, the aggregation procedure that transforms ballots into a choice of a candidate \parencite{Goodin_2006}, two perspectives of analysis ensue: static and dynamic. From a static point of view, the decision procedures respect differing criteria such as monotonicity, neutrality, anonymity, manipulability, and so on \parencite{nurmi1999voting}. From a dynamic point of view, politicians and voters continuously adapt to the rule in a system of feedback between the state and society \parencite{Wange2021systems}. In this article, I'll focus on two ways a decision procedure might reinforce destabilizing dynamics: by electing polarizing candidates and by electing candidates with weak mandates.


A polarizing or divisive candidate has strong support at the top
choice of voters, but also has a high share of bottom choices among the
electorate \parencite{igersheim22_compar_votin_method}.
The notion of a mandate of a candidate lets us situate both methods vis-{\`a}-vis
the one-choice informational environment typical of large-scale majoritarian
elections. At a minimum, a candidate has a mandate as long as it has won
under the voting procedure. A candidate has more mandate, however, the more significant
the difference between its vote share or score vs. the second most well-voted
candidate.

The destabilizing effects of electing divisive candidates or candidates with weak mandates are well-documented in the literature \parencite{kaminski2015empirical, luhrmann2018democracy, Baldassarrie2116863118, Bednare2113843118}. The paper focuses on the effect of decision procedures on that phenomenon. But why would, after all, voting procedures have such effect? For both a weak mandate and a polarizing candidate in the same example, suppose there are 11 voters with preference A > B > C > D, 10 voters with B > C > D > A, 10 voters with  C > B > D > A, 10 voters with D > B > C > A. A is naturally the plurality winner, even though it was only the electorate's top choice of \(27\%\) and was the bottom choice of the rest. It would lose in pairwise comparisons to all other alternatives. In this example, the alternative to win in all such pairwise comparisons would be B, a Condorcet Winner(BW). If we assigned weights \((3,2,1,0)\) to positions in the ranking and summed the scores, B would again be the winner, in this case, the Borda Winner (BW).


Note that being a CW is an even more robust notion of having a mandate. If the
candidate is a CW, then it would have won under all possible majority pairwise
comparisons against the other candidates. The BW lends itself to a similar
interpretation. Suppose a candidate wins under a voting procedure that only uses
the top choice of the electorate but is neither a BW nor a CW. In that case, it
has less mandate, in this generalized majoritarian perspective, than if it is
both, which signals a comprehensive social basis. In the former case, a
candidate who wins under the current voting procedure, but is neither a BW nor a
CW could be considered an artifact of the procedure. In the latter case, on the
other hand, the procedure would be just ``tracking'' a broader pattern of
support for the alternative.


This notion of mandate can be strengthened in the case of the Borda Count. The Borda count can be seen as one method within a family of methods that assign weights to positions in the ballot. In one extreme, the plurality voting method assigns a score 1 to the top choice and 0 to all others. On the other extreme is the antiplurality voting method, which assigns 1 to all positions besides the last one. Between the two extremes are all possible ways of assigning a score to the ballots of the electorate. The higher the proportion of positional voting systems that the candidate would have won had the election used it, what \textcite{tabarrok2001president} has called positional stability, the higher the mandate of the candidate.

Note that both notions, CW and BW, require broader informational input from
voters (their full ranking) while outputting a result, in principle, more
robust to divisiveness (since rejection is taken into account) and more refined
in terms of mandate (since we have moved from simply winning to winning either in
all pairwise comparisons or even in most or all possible positional voting
procedures). This broader informational backdrop underlies current research on
the case of the United States and Donald Trump's electoral victory. Regardless
of the specificities of each paper all presuppose that the informational paucity
of only focusing on top choices blinds the States' socio-technical translation
of popular support into political input (the choice of candidate).
For instance, \textcite{potthoff2021condorcet, woon2020trump, kurrild2018trump} debate whether
Donald Trump was a Condorcet Winner in the primaries, with recommendations of
voting procedures that better track what the CW is, after all.
\textcite{igersheim22_compar_votin_method} goes a step further: they argue that
not only was Trump neither, but Sanders was the actual Borda and Condorcet
Winner, and generally the ``best'' candidate, if by best one understand a candidate being the most inclusive and winning under the most alternative
decision procedures. We will see, however, that no such conclusion can be drawn
in the Brazilian case.

\section{Case/Data}

Jair Messias Bolsonaro was elected the president of Brazil in 2018. For more
than 20 years as a congressman, he was primarily a low clergy politician defending
the interests of the military and local police forces of the state of Rio de
Janeiro. The 2018 electoral scenario in Brazil was one of high rejection of the
traditional political elite, particularly of the Labour Party (Partido dos
Trabalhadores - PT), after corruption scandals and an impeachment process of the
previous president, Dilma Roussef, a Labor politician. The main contestants,
among 13, were him, a rightist candidate; Fernando Haddad, a leftist candidate
from PT; Geraldo Alckmin, a center-right candidate; and Ciro Gomes, a
center-left candidate. The presidential election in Brazil follows a two-round
system. In the first round, \(8.79\%\) of the votes were White/Null, which means
the voting procedure does not count them. The result of the valid votes was the
following: Bolsonaro:Haddad:Ciro:Alckmin:Others =
\(46.3:29.28:12.47:4.76:7.19 \). Among the 9 other candidates, the highest vote
share was Jo{\~a}o Amo{\^e}do's with \(2.5\%\). All others got less than \(1\%\).
Moreover, There was a \(20\%\) abstention. In the second round, the result was:
Bolsonaro:Haddad = \(55.12\% : 44.78\% \). White/Null votes were \(9.57\%\) of
the total electorate. The abstention in this round was \(21.3\%\).


The dataset used for the analysis is a representative street survey done on
10/02/2018, less than a week before the first round (10/07/2018). DataFolha did this survey, an independent research institute highly esteemed and
trusted by Brazilian experts\footnote{I had access to the survey data, code-book, and
  questionnaire by creating an account and requesting access to them,
  available for educational/research purposes, at
  \url{https://www.cesop.unicamp.br}.}. One question, in particular, is the only
variable in our analysis: pairwise comparisons between the 4 top candidates.
With it is possible to reconstruct the full 4-top ranking of the voter.
Preliminary pre-processing has led me to drop 171 observations where all
pairwise comparisons were missing and 132 in which they were cyclic. This leaves
us with 2937 out of 3240 observations. As Table~\ref{Tab:Tcpairwise} shows only
1797 observations compared all 4 candidates. As such, we have to augment the
data with transitive closures for 1140 observations by methods discussed in the
next section.

\begin{table}[]\centering
\resizebox{0.5\columnwidth}{!}{
\begin{tabular}{|l|r|}
\hline
Number of Pairwise Comparisons & Frequency \\ \hline
1                    & 15        \\ \hline
2                    & 42        \\ \hline
3                    & 462       \\ \hline
4                    & 118       \\ \hline
5                    & 503       \\ \hline
6                    & 1797      \\ \hline
\end{tabular}
}
\caption{Frequency of pairwise comparisons in the dataset.}

\label{Tab:Tcpairwise}
\end{table}


\section{Methods}

I use a preference learning model to infer incomplete rankings. A preference learning model is a statistical model tailored for estimating a ``consensus'' ranking from the data, imputation of incomplete rankings, and clustering the data into groups for predictive purposes \parencite{liu2019model}. Particularly, I use the Bayesian Mallows model as implemented\footnote{See \url{https://github.com/ocbe-uio/BayesMallows}.} in the BayesMallows R package \parencite{sorensen2019bayesmallows, lu2011learning}. The idea is to use a statistical model with distributions over the space of permutations \(P_{n}\). The likelihood, \(P(R = r \mid \alpha, \rho)\), of a voter profile \(R\) taking a value \(r \in P_{n}\), is a pdf conditional on what is the consensus ranking in the population, \(\rho\), and what is the concentration around the consensus ranking, \(\alpha\). The model assumes an exponential decay for the probability of a ranking happening as the distance between it and the consensus increases. Thus, for a prior for \(\alpha\) an exponential distribution is assumed, while for \(\rho\) a uniform prior is assumed. A joint posterior is then numerically calculated with an MCMC algorithm \parencite{sorensen2019bayesmallows}. Finally, the distribution is used to infer latent rankings for the incomplete rankings seen in the sample\footnote{The data is augmented while the Markov chain is running and is continuously updated throughout the algorithm loop. I just recovered the last iteration of the chain.} \parencite{sorensen2019bayesmallows}. I ran the chain for 2000 iterations. The diagnostics for the inference are shown in Appendix~\ref{appendix:diagnostics}.


After the rankings are inferred, I compute the Borda Count and Condorcet Procedure for the top
4 candidates, calculate the victory scenarios for all positional voting methods,  and visualize the results for 3 candidates using Saari's representation triangles \parencite{saari2012geometry}.

Saari's representation triangles provide a way of visualizing all possible
positional voting results of an election\footnote{For a complete exposition of
  this method see \textcite{saari1995basic} or \textcite{nurmi2002voting}.}. Consider Figure \ref{fig:saari_nurmi}. The closer to a vertex, the better the vertex's position in the social ranking. Region 1 corresponds to the social ranking of \(A > B > C\), while Region 4 corresponds to the social ranking of \(C>B>A\). The lines separating the regions represent indifference. The point in which all lines meet corresponds to \(A \sim B \sim C\), while the line separating Region 1 and 2 would correspond to \(A > B \sim C\). The three dots are the results for the antiplurality, the borda and the plurality voting methods. The line connecting the antiplurality and plurality results, the extremes, denotes all possible positional results, including the result for the Borda Count. The Borda Count point is always closer to the antiplurality result. In this example, most positional voting methods would have agreed with the plurality procedure outcome of \(B\) as the winner.

\begin{figure}[H]
 \centering
 \includegraphics[width=0.8\columnwidth,
 height=0.3\textheight]{./images/simpletriangle.png}
 \caption{Saari representation triangle}
 \label{fig:saari_nurmi}
\end{figure}

To calculate all positional voting victories I use two facts proved by Donald Saari \parencite{saari2012geometry, saari2001chaotic}: first, any positional voting method for 4 candidates can be seen as assigning weights to rank positions in a standardized manner \((1,s_{1},s_{2},0)\), where \(0 \leq s_{2} \leq s_{1} \leq 1\); second, all such procedures will lie in the convex hull of the plurality, antiplurality and vote for two procedures, with respective weights of \((1,0,0,0), (1,1,1,0), (1,1,0,0)\). Calculating scenarios amounts, thus, to vary the values of \(s_{1}\) and \(s_{2}\).

A further complication is a mismatch between the survey's
plurality result and the actual result of the first round. This is typical in
surveys and might be due to strategic voting, social desirability bias (not
wanting to be seen as ``polarized''), or systematic refusal of part of the electorate
to answer the survey. Any imputation technique will reproduce this top-choice discrepancy. Thus I'll show directly the mismatch between the
imputation and the actual vote\footnote{In a further version of this working
  paper I'll show this directly, then contrast with the imputed data. They,
  thankfully, match,I'm just time-constrained.}. I ran the imputation algorithm
on the top 4 candidates, which means that in the sample the \(7.19\%\) that
voted for others is kept constant. The result after applying the algorithm is
Bolsonaro:Haddad:Ciro:Alckmin:Others = \(36.7.7\% : 17.3\% : 14.1\% :7.19\% \).
Thus, Bolsonaro and Haddad are undervoted in the sample, while Ciro and Alckmin
are overvoted\footnote{Remember the actual result was
  Bolsonaro:Haddad:Ciro:Alckmin:Others = \(46.3:29.28:12.47:4.76:7.19 \).}. If
we were transferring the top choices from over-voted to under-voted, we
could simply transfer Alckmin \(\rightarrow\) Bolsonaro and Ciro \(\rightarrow\) Haddad.
However, there are 24 permutations of the top 4 candidates, with 6 for each
candidate in which they are the top alternative, which gives leeway to many
possible transfers. I have designed an algorithm, described in Appendix
\ref{appendix:transfer}, that while respecting who can transfer and who needs
votes, respects the Kemeny's Distance between the rankings and picked the
transferred table that minimizes the Euclidean distance between the inferred
table and the actual election. Two such inferred tables lead to the following
proportion: Bolsonaro:Haddad:Ciro:Alckmin:Others =
\(46.19:29.32:12.51:4.77:7.19 \). Since applying electoral procedures
to those tables leads to qualitatively similar results, I'll present the
results for one of them. The results for the other are in Appendix
\ref{appendix:transfer2_results}

\section{Results}
The inferred rankings\footnote{The whole table is shown in Appendix
  \ref{appendix:inferred1}.} are summarized in Figure \ref{fig:counts}. Indeed,
the candidates that went to the second round were the most divisive ones. Ciro,
however, could be considered more inclusive than Alckmin since the proportion
of last choices within Alckmin's subset of voters is higher than Ciro's. There
is also a relevant distinction among the divisive candidates: Haddad's rejection
was higher than his top-choice support, while the opposite held for Bolsonaro.

\begin{figure}[H]
 \centering
 \includegraphics[width=0.8\columnwidth,
 height=0.5\textheight]{./images/corrected1_indexes_plot.png}
 \caption{Frequency candidates appear at each position}
 \label{fig:counts}
\end{figure}

Nevertheless, what does this support distribution mean from the point of view of the Borda and Condorcet procedures? Table \ref{tbl:tab1} shows what we can infer from the imputed data. Despite being divisive, Bolsonaro would have won in all pairwise majority comparisons against any other top candidates. Haddad, however, would have lost against Ciro, who would only have lost against Bolsonaro. Unlike what was widely believed at the time and was the motto of his campaign, Ciro most likely would not have won against Bolsonaro in a second round. He was not the ``anti-Bolsonaro'', but merely an ``anti-Haddad'', together with Bolsonaro. Alckmin, the candidate with the longest television time and the broadest supporting coalition, would have lost against any other top candidates. He was the Condorcet Loser in the top set. The same pattern is reflected in the Borda Scores: Bolsonaro > Ciro > Haddad > Alckmin.


% latex table generated in R 4.2.1 by xtable 1.8-4 package
% Thu Dec  1 21:18:51 2022
\begin{table}[h]
\begin{subtable}[h]{0.4\textwidth}
\centering
\begin{tabular}{rrrrr}
  \hline
 & Alckmin & bolsonaro & ciro & haddad \\
  \hline
Alckmin & 0 & -1 & -1 & -1 \\
  bolsonaro & 1 & 0 & 1 & 1 \\
  ciro & 1 & -1 & 0 & 1 \\
  haddad & 1 & -1 & -1 & 0 \\
   \hline
\end{tabular}
\caption{Pairwise Majority Comparisons}
\label{tbl:subtab1}
\end{subtable}
\hfill
\begin{subtable}[h]{0.4\textwidth}
  \centering
\begin{tabular}{rr}
  \hline
 & Borda score \\
  \hline
Alckmin & 6527 \\
  Bolsonaro & 8185 \\
  Ciro & 7617 \\
  Haddad & 7041 \\
   \hline
\end{tabular}
\caption{Borda scores}
\label{tbl:subtab2}
\end{subtable}
\caption{Borda and Condorcet results for final inferred ranking 1}
\label{tbl:tab1}
\end{table}


The counterfactual analysis can be deeper in the case of positional voting
methods. As discussed in the methods section, with 4 candidates, all results will
lie in the convex hull of three positional voting procedures: plurality,
antiplurality, and vote for two. Note that the score of a candidate will be of the
form \(a + bs_{1} + cs_{2}\), where a is the share it received of votes in the
first position, b in the second, and d in the third position of voters rankings.
Therefore, the scores of each candidate in the inferred ranking for the 2018 election can be found by assigning values to the equations of Table
\ref{tab:ws}. For instance, if we set \(s_{1} = s_{2} = 0\) we recover the
plurality score, after ignoring ``Other'' candidates.

\begin{table}
  \centering
  \begin{tabular}{rr}
    \hline\hline
    \textbf{candidates} & \textbf{\(w_s\) tallies} \\
    Alckmin & 0.3415\(s_1\) + 0.385\(s_2\) + 0.0514 \\
    Bolsonaro & 0.0988\(s_1\) + 0.0919\(s_2\) + 0.499 \\
    Ciro & 0.4358\(s_1\) + 0.3173\(s_2\) + 0.1348 \\
    Haddad & 0.1238\(s_1\) + 0.2057\(s_2\) + 0.3147 \\\hline\hline
  \end{tabular}
  \caption{\(w_{s}\) vector of each top 4 candidate}
  \label{tab:ws}
\end{table}


Algebraic manipulation allows us to, then, answer the following question: Under what scenarios would candidate A have beaten candidate B in the universe of positional voting methods? Table \ref{tab:percentage} gives the Percentage of scenarios in which this would have happened. It shows that even though Bolsonaro was both the Borda and Condorcet Winner, there were scenarios in which he would have lost to the more inclusive candidates, Ciro and Alckmin. In Alckmin's case, this would only have happened in \(5\%\) of the cases. However, Ciro could have beaten him in \(\approx 30\%\) of the positional voting methods. Surprisingly, Haddad, who went to the second round with Bolsonaro, would never have beaten him. The explanation for that is the following: as shown in Figure \ref{fig:counts}, Haddad and Bolsonaro were both divisive candidates. However, Bolsonaro had more support than Haddad. Therefore, they were not equally supported/rejected. Given that they were both divisive, most of their support was in the top choice, they would have fared equally well or badly under the same positional voting methods, but since Bolsonaro had more first votes and was less in the bottom of the rankings than Haddad he actually ``positionally dominated'' Haddad. The same logic applies to a other surprising result: Alckmin would never have beaten Ciro.


\begin{table}[]
  \centering
\begin{tabular}{|r|r|r|r|r|}
\hline
\textbf{candidates} & \textbf{Alckmin} & \textbf{bolsonaro} & \textbf{ciro} & \textbf{haddad} \\ \hline
Alckmin             & -             & 0.05               & 0.0           & 0.25            \\ \hline
bolsonaro           & 0.95             & -            & 0.69          & 1.0             \\ \hline
Ciro                & 1.0              & 0.31               & -           & 0.76            \\ \hline
haddad              & 0.75             & 0.0                & 0.24          & -            \\ \hline
\end{tabular}
\caption{Percentage of positional victories of row against column}
\label{tab:percentage}
\end{table}


Naturally, percentages do not show what scenarios, for instance, Ciro would have beaten Bolsonaro. Intuitively, voting procedures that emphasize rejection or more of the middle region of the rankings should give an advantage to inclusive candidates. Since the positional voting methods with four candidates are determined by their \(s_{1}\) and \(s_{2}\) weights, we can visualize all scenarios by varying them,   as in Figure~\ref{fig:positional4c}. It shows the scenarios Bolsonaro \(\times\) Ciro, Ciro \(\times \) Haddad, and Alckmin \(\times\) Bolsonaro. Note that, as expected, the only way Alckmin could have beaten Bolsonaro would be if \(s_{1}\) and \(s_{2}\) were close to 0.8. Remember that when both are 1, the voting procedure is equivalent to saying which candidate you do not like. However, this universe of cases was dominated by Ciro, who would have beaten Bolsonaro in any combination of \(s_{1}\) and \(s_{2}\) higher than the line connecting the points \((0.64,0.64)\) and \((1,0.12)\). The plot also shows what combinations of weights lead to \(76\%\) of Ciro \(>\) Haddad: any combination of weights higher than the line segment between \((0.42,0.42)\) and \((0.57,0.0)\).

\begin{figure}[H]
 \centering
 \includegraphics[width=\columnwidth,
 height=0.3\textheight]{./images/positional_results.png}
\caption{Victory in terms of values of \(s_{1}\) and \(s_{2}\)}
 \label{fig:positional4c}
\end{figure}



% \begin{table}[]
%     \centering
% \begin{tabular}{|r|r|r|r|}
% \hline
% \textbf{candidates} & \textbf{antiplurality} & \textbf{vote for two} & \textbf{plurality} \\ \hline
% Alckmin             & 0.7779                 & 0.3929                & 0.0514             \\ \hline
% Bolsonaro           & 0.6897                 & 0.5978                & 0.499              \\ \hline
% Ciro                & 0.8879                 & 0.5706                & 0.1348             \\ \hline
% Haddad              & 0.6442                 & 0.4385                & 0.3147             \\ \hline
% \end{tabular}
% \caption{Tallies for boundary positional methods (dropping ``Others'' )}
% \label{tab:positional4c}
% \end{table}


However, neither the CW nor the family of positional voting methods is, in
general, Independent of the Alternative Set\parencite{kaminski2015empirical}.
If we drop or add candidates, the ``social'' ranking might change
without respecting the ordering of the baseline set of alternatives. Consider
the Borda-induced social ranking in this case: Bolsonaro > Ciro > Haddad >
Alckmin. If by dropping Alckmin, the ranking changes to Ciro > Bolsonaro >
Haddad, then the Borda Count, in this case, would be inducing a ``paradoxical.''
result. In Figure ~\ref{fig:c1dropping} we consider alternative scenarios by
dropping one of the top 4 candidates. Not only can we determine if there is any ``alternative set stability'', but we also consider the positional stability of the result.

Regarding alternative set stability, the positional voting
procedures are eminently well-behaved when applied to this dataset. The only reversal is the
antiplurality ranking if Haddad had dropped. In this case, Figure
~\ref{fig:c1dropping} (d), the antiplurality ranking was  Ciro > Alckmin >
Bolsonaro > Haddad, but now the ranking is Ciro > Bolsonaro > Alckmin. The
reason is that Haddad's votes were most likely transferred more to Ciro
than to Alckmin. The antiplurality point, however, is close to a tie
between Bolsonaro and Alckmin, which means this can also be an artifact
of sampling uncertainty.


What about positional stability across the alternative sets? Notice that in all scenarios where Bolsonaro is still in the alternative set, he would have been both the plurality and the Borda winner, and most positional voting methods would have elected him. The only counterfactual positional results in which he would not have been elected is if a voting procedure that emphasized rejection had been used, and Ciro would then have been elected. Those scenarios, however, are, in these cases, Figure \ref{fig:c1dropping} (a,c,d), always a minority. His victory, thus, was not a fluke or an artifact of institutional technology. Not only would he have won under both Borda and Condorcet methods, but his victory was also stable under both alternative sets of options and positional methods. Even though electoral systems based on just the first positions of citizens' preferences do ignore, by definition, the distribution of support, the candidates have throughout the whole rankings, we could expect that divisive candidates would fare worse under informationally richer decision procedures, a divisive candidate can still be a CW with high positional stability. Therefore, highly polarized scenarios can lead to the election of a divisive candidate regardless of which reasonable decision procedure is used\footnote{Emphasizing rejection rather than overall support across the ranking (as in, say, the Borda Count) seems unreasonable under any set of normative expectations demanded of a decision procedure for large scale democratic elections.}.


However, Figure~\ref{fig:c1dropping} (c) presents an interesting scenario.
Though, as expected, Haddad would have been the plurality winner\footnote{As
  shown in Figure \ref{fig:c2dropping} in Appendix
  \ref{appendix:transfer2_results}, this is a case in which the vote transfers
  differ. In the alternative vote transfer, in this scenario, Ciro would have
  tied with Haddad in the plurality case but would have won under all other
  positional voting methods.}, now his victory would not have been positionally
stable. In Table \ref{tbl:subtab1} it was shown that Ciro would have
beaten him with a majority pairwise comparison, which gives credence to affirming
that Ciro would have won under a majority with run-off system. In this scenario
the most inclusive candidate would have been elected. Ceteris paribus, it seems the ``only'' way Bolsonaro would not have been elected in the 2018 election would have been if he had never been able to run.

% Within Latin America,
% Brazil sticks out for its lack of transitional justice
% \parencite{nalepa2022after}. The remnants of the old regime were never punished,
% and Bolsonaro is an instance of such group. It is no coincidence that after being
% elected he assigned \(70\%\) more military to public administration positions
% traditionally held by civilians. Or that in his term the army re-emerged in the
% country as a prominent political actor, with generals feeling comfortable to
% periodically remind the civil society that the military forces function as a
% ``moderating power''\footnote{As the Emperor used to do before the
%   Independence.} in the political system.



% If wolves in sheep clothes are at the
% door, as characterized by \textcite{chiopris2021wolf}, then maybe citizens
% should not leave it open for them. This leads to an empirical implication for
% the subset of transitional democracies (those that are still in the process of
% democratization \parencite{svolik2008authoritarian}): the election of closet
% authoritarians is more probable in countries that have a military dictatorship
% past, but didn't go through a transitional justice process
% \parencite{geddes1999we}. Testing it is a subject of future studies.




% Case a:
% - plurality bhc
% - antiplurality cbh
% - borda: bch

% Case b:
% - plurality: hca
% - borda: cha
% - antiplurality: c(ha)

% Case c:
% - plurality: bha
% - antiplurality: abh
% - borda: bha

% Case d:
% - plurality: BCA
% - antiplurality: CBA
% - borda: BCA

   \begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.475\textwidth}
            \centering
            \includegraphics[width=\textwidth]{./images/cw1_nota.png}
             \caption{}%
            % {{\small Network 1}}
            \label{fig:notac1}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.475\textwidth}
            \centering
            \includegraphics[width=\textwidth]{./images/cw1_notb.png}
             \caption{}%
            % {{\small Network 2}}
            \label{fig:notbc1}
        \end{subfigure}
        \vskip\baselineskip
        \begin{subfigure}[b]{0.475\textwidth}
            \centering
            \includegraphics[width=\textwidth]{./images/cw1_notc.png}
            \caption{}%
            \label{fig:notbc1}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.475\textwidth}
            \centering
            \includegraphics[width=\textwidth]{./images/cw1_noth.png}
             \caption{}%
            % {{\small Network 4}}
            \label{fig:notah1}
        \end{subfigure}
        \caption[  Positional results when dropping one candidate ]
        {\small Positional results after dropping one candidate }
        \label{fig:c1dropping}
    \end{figure}


\section{Conclusion}

The paper contributes to the analysis of the institutional robustness of
polyarchical systems by considering credible alternative voting procedures
outcomes and properties at a critical juncture in Brazil's political history. We have demonstrated empirically that Bolsonaro's victory was not caused by the decision procedure, contrary to established theoretical expectations.

Regarding future research, it is relevant to notice that the 2018 election was marked by two events. First, the main leftist candidate,Lula, was prevented from running. He was arrested in the beginning of the electoral campaigns, the process was deemed suspicious in 2021 since the judge\footnote{Bolsonaro nominated this judge Minister of Justice.} was cooperating with the prosecutor, and he won in 2022, in a electoral process marked by irregularities in favor of Bolsonaro. The distribution of support for Lula was markedly different from Haddad, who was merely his replacement. Second, in 09/06/2018, a month before the first round, there was an assassination attempt against Bolsonaro. The knife attack most likely changed the pattern of support for him. Contrasting Haddad with Lula and analyzing the effect of the knife attack will provide a more comprehensive picture of what happened in 2018.


The most glaring limitation of the paper is that agents adapt to new
institutional environments. We are ignoring strategic voting by assuming a direct
translation between preferences and behavior.
However, the percentage of strategic voting in a large-scale election is an
open empirical problem \parencite{straeten10_strat_sincer_heuris_votin_under,kawai2013inferring}. Nevertheless, a
combination of game-theoretic models with a simulation parameterized by the
inferred ranking distribution is a route of research that I intend to pursue.

The research used only one variable from the dataset, pairwise
comparisons, to simulate alternative scenarios. However, socio-demographic
variables from the dataset could have been used to strengthen the data
imputation procedure. Speaking of imputation, simpler imputations, such as the
Impartial Culture assumption \parencite{regenwetter2006behavioral}, could have been
used as benchmarks to compare with the imputation through the bayesian mallows
model. Moreover, properly analyzing the pattern of missingness
of pairwise comparisons is necessary. Roughly less than half of the dataset is constituted of
incomplete pairwise comparisons, and there might be valuable information on the
agent's preferences contained in patterns of missingness
\parencite{mcelreath2020statistical}.

Moreover, we have been disregarding indifference to the agent's preferences.
Again, this is valuable information, and it is known that forcing strict
preferences when indifference exists leads to artificial inflation of the
profile inconsistency \parencite{gehrlein2010impact}. Though we have analyzed
the four top candidates, there is no direct relationship between the result of
an election with positional procedures when we have a subset of the alternatives
vs. when we have the whole set of candidates \parencite{saari2001chaotic}. It is
well-known, for instance, that the Borda Count violates WARP precisely because
it is not contraction-expansion consistent \parencite{schwartz2018cycles}.
Nonetheless, we expect that the results will remain the same, given that the
bottom candidates could be deemed irrelevant to most of the population (and, as
such, be tied to the bottom of the rankings), and the results were stable to dropping one top candidate. This is a subject for a more thorough analysis, in
any case. Finally, even though we have analyzed scenarios in which candidates
were removed, it would have been more realistic to simulate the formation of
coalitions and how voters would have reacted to those. The assumption of a pure
additive transfer of votes, implicit when we removed candidates, is not
necessarily valid with coalitions, insofar voters of a center-left candidate,
for instance, could actually vote for the center-right candidate if they are
alienated by an alliance with the Left, which in the case of the election under
scrutiny, was highly rejected, as shown in our analysis.


\printbibliography
\pagebreak
\appendix
\section{The vote transfer algorithm}\label{appendix:transfer}

 If we are to transfer from Alckmin to Bolsonaro, we are lead to the problem of first
picking which ranking at the source should be chosen then which ranking at the
target should receive votes, while respecting how much the source has in excess
and how much the target needs\footnote{In a further version of this paper
  I'll describe this with the help of a pseudo-code of the algorithm. \textcolor{red}{SHOULD I?}}. A
natural sorting of which ranking should be the source is the position of
Bolsonaro in the ranking. We start with rankings in which he is in the second
position ((Alckmin, Bolsonaro, Ciro, Haddad), (Alckmin, Bolsonaro, Haddad,
Ciro)), then third position ((Alckmin, Ciro, Bolsonaro, Haddad), (Alckmin,
Haddad, Bolsonaro, Ciro )), then last position ((Alckmin, Ciro, Haddad,
Bolsonaro), ((Alckmin, Haddad, Ciro, Bolsonaro))). Let's call those sets the
sorted rankings sets. Suppose we picked a source ranking from the first sorted
rankings set. What should be the target ranking among the rankings which have
Bolsonaro as the first choice? We transfer to the ranking that has minimal
Kemeny's distance to the source ranking \parencite{nurmi2002voting}. The Kemeny
distance counts the number of transpositions (switching of pairs) needed to go
from one permutation to another permutation. Thus, we transfer from the source
ranking the min(number of votes the source ranking has, the total number of
votes the under-voted needs, the total number of votes the over-voted can give).
We update the source ranking frequency, the target ranking frequency, the total
number of votes the under-voted needs, and the total number of votes the
over-voted can give. If the under-voted does not need any other votes we stop and
go to another over-voted \(\to\) under-voted transfer. If not we check if the
over-voted can still transfer votes to the current target under-voted. If yes we
pick another source ranking in the sorted rankings sets and repeat until either
the source has run out of votes it can give or the target has received enough
votes. If not we go to another over-voted \(\to\) under-voted transfer. In the end, this leads to 24 possible transfer sequences from over-voted
to under-voted. One possible sequence is Alckmin \(\to\) Bolsonaro, then Alckmin
\(\to\) Haddad, then Ciro \(\to\) Haddad, then Ciro \(\to\) Bolsonaro. Another
possible sequence is  Alckmin \(\to\) Bolsonaro, then Alckmin \(\to\) Haddad, then
Ciro \(\to\) Bolsonaro, then Ciro \(\to\) Haddad. This leads to 6 transfers that
minimize the euclidean distance between the inferred plurality result and actual
result of the first round. However, there are actually two equivalence classes
among those 6: 3 have the same proportion for each ranking, while the other 3
have the same proportion for each ranking. The new inferred proportion for both
classes is: Bolsonaro:Haddad:Ciro:Alckmin:Others =
\(46.19:29.32:12.51:4.77:7.19 \).


\section{Convergence Diagnostics}\label{appendix:diagnostics}

Figure~\ref{fig:alphac} shows the trace plot for \(\alpha\). It shows the mcmc did not diverge for this parameter.

\begin{figure}[H]
 \centering
 \includegraphics[width=0.8\columnwidth,
 height=0.5\textheight]{./images/alpha_conv.png}
 \caption{Diagnostics for parameter \(\alpha\)}
 \label{fig:alphac}
\end{figure}

Figure~\ref{fig:rhoc} shows the trace for \(\rho\). In this case we have Items 1,2,3,4 are respectively Ciro,Haddad,Alckmin,Bolsonaro. However, for some reason the expected distance of the candidates did not change throughout the loop. \textcolor{red}{I'm not sure what this means to be sincere. I have to schedule a meeting with professor Levin to discuss that}. \textbf{I'll most likely need to tweak the parameters' values to get a better trace plot for both.}.

\begin{figure}[H]
 \centering
 \includegraphics[width=0.8\columnwidth,
 height=0.5\textheight]{./images/rho_conv.png}
 \caption{Diagnostics for parameter \(\rho\)}
 \label{fig:rhoc}
\end{figure}





\section{Inferred Ranking Table} \label{appendix:inferred1}


\begin{table}[H]
  \centering
\begin{tabular}{|r|r|}
\hline
\textbf{ranking vectors}                           & \textbf{percentage} \\ \hline
Haddad \textgreater Ciro \textgreater Alckmin \textgreater bolsonaro & 17.19                                \\ \hline
bolsonaro \textgreater Alckmin \textgreater Ciro \textgreater Haddad & 13.99                                \\ \hline
bolsonaro \textgreater Ciro \textgreater Alckmin \textgreater Haddad & 13.72                                \\ \hline
bolsonaro \textgreater Ciro \textgreater Haddad \textgreater Alckmin & 8.85                                 \\ \hline
Haddad \textgreater Alckmin \textgreater Ciro \textgreater bolsonaro & 7.12                                 \\ \hline
bolsonaro \textgreater Haddad \textgreater Ciro \textgreater Alckmin & 6.26                                 \\ \hline
Ciro \textgreater Alckmin \textgreater Haddad \textgreater bolsonaro & 5.04                                 \\ \hline
bolsonaro \textgreater Alckmin \textgreater Haddad \textgreater Ciro & 4.36                                 \\ \hline
Haddad \textgreater Ciro \textgreater bolsonaro \textgreater Alckmin & 3.51                                 \\ \hline
Alckmin \textgreater bolsonaro \textgreater Ciro \textgreater Haddad & 2.79                                 \\ \hline
bolsonaro \textgreater Haddad \textgreater Alckmin \textgreater Ciro & 2.72                                 \\ \hline
Ciro \textgreater Alckmin \textgreater bolsonaro \textgreater Haddad & 2.72                                 \\ \hline
Ciro \textgreater bolsonaro \textgreater Alckmin \textgreater Haddad & 2.04                                 \\ \hline
Ciro \textgreater Haddad \textgreater Alckmin \textgreater bolsonaro & 1.67                                 \\ \hline
Haddad \textgreater bolsonaro \textgreater Ciro \textgreater Alckmin & 1.57                                 \\ \hline
Alckmin \textgreater bolsonaro \textgreater Haddad \textgreater Ciro & 1.5                                  \\ \hline
Ciro \textgreater Haddad \textgreater bolsonaro \textgreater Alckmin & 1.19                                 \\ \hline
Haddad \textgreater bolsonaro \textgreater Alckmin \textgreater Ciro & 1.16                                 \\ \hline
Haddad \textgreater Alckmin \textgreater bolsonaro \textgreater Ciro & 0.92                                 \\ \hline
Ciro \textgreater bolsonaro \textgreater Haddad \textgreater Alckmin & 0.82                                 \\ \hline
Alckmin \textgreater Haddad \textgreater bolsonaro \textgreater Ciro & 0.54                                 \\ \hline
Alckmin \textgreater Ciro \textgreater bolsonaro \textgreater Haddad & 0.31                                 \\ \hline
\end{tabular}
\caption{Inferred rankings}
\label{lab:inferred1}
\end{table}


\section{The results for the other inferred table}\label{appendix:transfer2_results}

\begin{table}[H]
  \centering
\begin{tabular}{|r|r|}
\hline
\textbf{ranking vectors}                           & \textbf{percentage} \\ \hline
bolsonaro \textgreater Alckmin \textgreater Ciro \textgreater Haddad & 13.99                                \\ \hline
bolsonaro \textgreater Ciro \textgreater Haddad \textgreater Alckmin & 13.69                                \\ \hline
Haddad \textgreater Ciro \textgreater Alckmin \textgreater bolsonaro & 12.36                                \\ \hline
bolsonaro \textgreater Ciro \textgreater Alckmin \textgreater Haddad & 11.1                                 \\ \hline
Haddad \textgreater Alckmin \textgreater Ciro \textgreater bolsonaro & 9.33                                 \\ \hline
Haddad \textgreater Ciro \textgreater bolsonaro \textgreater Alckmin & 6.13                                 \\ \hline
Ciro \textgreater Alckmin \textgreater Haddad \textgreater bolsonaro & 5.04                                 \\ \hline
bolsonaro \textgreater Alckmin \textgreater Haddad \textgreater Ciro & 4.36                                 \\ \hline
bolsonaro \textgreater Haddad \textgreater Ciro \textgreater Alckmin & 4.05                                 \\ \hline
Alckmin \textgreater bolsonaro \textgreater Ciro \textgreater Haddad & 2.79                                 \\ \hline
bolsonaro \textgreater Haddad \textgreater Alckmin \textgreater Ciro & 2.72                                 \\ \hline
Ciro \textgreater Alckmin \textgreater bolsonaro \textgreater Haddad & 2.72                                 \\ \hline
Ciro \textgreater bolsonaro \textgreater Alckmin \textgreater Haddad & 2.04                                 \\ \hline
Ciro \textgreater Haddad \textgreater Alckmin \textgreater bolsonaro & 1.67                                 \\ \hline
Haddad \textgreater bolsonaro \textgreater Ciro \textgreater Alckmin & 1.57                                 \\ \hline
Alckmin \textgreater bolsonaro \textgreater Haddad \textgreater Ciro & 1.5                                  \\ \hline
Ciro \textgreater Haddad \textgreater bolsonaro \textgreater Alckmin & 1.19                                 \\ \hline
Haddad \textgreater bolsonaro \textgreater Alckmin \textgreater Ciro & 1.16                                 \\ \hline
Haddad \textgreater Alckmin \textgreater bolsonaro \textgreater Ciro & 0.92                                 \\ \hline
Ciro \textgreater bolsonaro \textgreater Haddad \textgreater Alckmin & 0.82                                 \\ \hline
Alckmin \textgreater Haddad \textgreater bolsonaro \textgreater Ciro & 0.54                                 \\ \hline
Alckmin \textgreater Ciro \textgreater bolsonaro \textgreater Haddad & 0.31                                 \\ \hline
\end{tabular}
\caption{Second minimizing inferred rankings - one ranking got 0 votes after the transfer}
\end{table}



\begin{figure}[H]
 \centering
 \includegraphics[width=0.8\columnwidth,
 height=0.5\textheight]{./images/corrected2_indexes_plot.png}
 \caption{Number of times candidates appear at each position - final ranking 2}
\end{figure}

% latex table generated in R 4.2.1 by xtable 1.8-4 package
% Thu Dec  1 21:18:52 2022
\begin{table}[H]
  \begin{subtable}[h]{0.4\textwidth}
    \centering
\begin{tabular}{rrrrr}
  \hline
 & Alckmin & bolsonaro & ciro & haddad \\
  \hline
Alckmin & 0 & -1 & -1 & -1 \\
  bolsonaro & 1 & 0 & 1 & 1 \\
  ciro & 1 & -1 & 0 & 1 \\
  haddad & 1 & -1 & -1 & 0 \\
   \hline
\end{tabular}
\caption{Pairwise Majority Comparisons }
\end{subtable}
\hfill
\begin{subtable}[h]{0.4\textwidth}
\centering
\begin{tabular}{rr}
  \hline
 & borda2\$other\_info\$count\_max \\
  \hline
Alckmin & 6438 \\
  bolsonaro & 8262 \\
  Ciro & 7617 \\
  Haddad & 7053 \\
   \hline
\end{tabular}
\caption{Borda scores}
\end{subtable}
\caption{Borda and Condorcet results for final inferred ranking 2}
\end{table}


   \begin{figure*}
        \centering
        \begin{subfigure}[b]{0.475\textwidth}
            \centering
            \includegraphics[width=\textwidth]{./images/cw2_nota.png}
             \caption{}%
            % {{\small Network 1}}
            \label{fig:notac2}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.475\textwidth}
            \centering
            \includegraphics[width=\textwidth]{./images/cw2_notb.png}
             \caption{}%
            % {{\small Network 2}}
            \label{fig:notbc2}
        \end{subfigure}
        \vskip\baselineskip
        \begin{subfigure}[b]{0.475\textwidth}
            \centering
            \includegraphics[width=\textwidth]{./images/cw2_notc.png}
            \caption{}%
%            {{\small Network 3}}
            \label{fig:notbc2}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.475\textwidth}
            \centering
            \includegraphics[width=\textwidth]{./images/cw2_noth.png}
             \caption{}%
            % {{\small Network 4}}
            \label{fig:notahc2}
        \end{subfigure}
        \caption[  Positional results when dropping one candidate ]
        {\small Positional results after dropping one candidate - second possible vote transfer }
        \label{fig:c2dropping}
    \end{figure*}



\end{document}

